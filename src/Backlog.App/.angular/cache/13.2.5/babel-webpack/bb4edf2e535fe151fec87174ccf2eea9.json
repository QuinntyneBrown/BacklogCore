{"ast":null,"code":"import { FormControl } from '@angular/forms';\nimport { MAT_DIALOG_DATA } from '@angular/material/dialog';\nimport { Destroyable } from '@core';\nimport { BehaviorSubject, of } from 'rxjs';\nimport { map, startWith, switchMap, takeUntil, tap } from 'rxjs/operators';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@api\";\nimport * as i2 from \"@angular/material/dialog\";\nimport * as i3 from \"../../../atoms/title-bar/title-bar.directive\";\nimport * as i4 from \"@angular/material/button\";\nimport * as i5 from \"@angular/material/icon\";\nimport * as i6 from \"@angular/common\";\nimport * as i7 from \"@angular/material/form-field\";\nimport * as i8 from \"@angular/material/input\";\nimport * as i9 from \"@angular/forms\";\nimport * as i10 from \"@angular/material/autocomplete\";\nimport * as i11 from \"@angular/material/core\";\n\nfunction AddDependencyRelationshipDialogComponent_div_7_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 13)(1, \"h1\");\n    i0.ɵɵtext(2);\n    i0.ɵɵelementEnd()();\n  }\n\n  if (rf & 2) {\n    const story_r4 = ctx.ngIf;\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate2(\"\", story_r4.name, \": \", story_r4.title, \"\");\n  }\n}\n\nfunction AddDependencyRelationshipDialogComponent_mat_option_15_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"mat-option\", 14);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const option_r5 = ctx.$implicit;\n    i0.ɵɵproperty(\"value\", option_r5);\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\" \", option_r5.name, \" \");\n  }\n}\n\nfunction AddDependencyRelationshipDialogComponent_span_18_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"span\");\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const story_r6 = ctx.$implicit;\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\" \", story_r6, \" \");\n  }\n}\n\nexport class AddDependencyRelationshipDialogComponent extends Destroyable {\n  constructor(_story, _storyService, _dialogRef) {\n    super();\n    this._storyService = _storyService;\n    this._dialogRef = _dialogRef;\n    this.searchControl = new FormControl(null, []);\n    this.story$ = new BehaviorSubject(null);\n    this.stories$ = new BehaviorSubject([]);\n    this.filteredOptions = this.searchControl.valueChanges.pipe(startWith(\"\"), map(value => typeof value === \"string\" ? value : value && value.name), switchMap(name => name ? this._storyService.search({\n      query: name\n    }) : of([])));\n\n    this.displayWith = value => value === null || value === void 0 ? void 0 : value.name;\n\n    this.stories$.next(_story.dependsOn);\n    this.story$.next(_story);\n  }\n\n  storySelected($event) {\n    var stories = this.stories$.value;\n    const index = stories.indexOf($event.option.value.name);\n\n    if (index == -1) {\n      stories.push($event.option.value.name);\n    } else {\n      stories.splice(index, 1);\n    }\n\n    this.stories$.next(stories);\n    this.searchControl.reset();\n  }\n\n  save() {\n    this._storyService.updateDependsOn({\n      storyId: this.story$.value.storyId,\n      dependsOn: this.stories$.value\n    }).pipe(takeUntil(this._destroyed$), tap(_ => {\n      this._dialogRef.close(true);\n    })).subscribe();\n  }\n\n}\n\nAddDependencyRelationshipDialogComponent.ɵfac = function AddDependencyRelationshipDialogComponent_Factory(t) {\n  return new (t || AddDependencyRelationshipDialogComponent)(i0.ɵɵdirectiveInject(MAT_DIALOG_DATA), i0.ɵɵdirectiveInject(i1.StoryService), i0.ɵɵdirectiveInject(i2.MatDialogRef));\n};\n\nAddDependencyRelationshipDialogComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n  type: AddDependencyRelationshipDialogComponent,\n  selectors: [[\"bl-add-dependency-relationship-dialog\"]],\n  features: [i0.ɵɵInheritDefinitionFeature],\n  decls: 25,\n  vars: 12,\n  consts: [[\"bl-title-bar\", \"\"], [\"bl-title\", \"\"], [\"mat-icon-button\", \"\", \"tabindex\", \"-1\", 3, \"mat-dialog-close\"], [\"class\", \"add-dependency-relationship-dialog__story\", 4, \"ngIf\"], [1, \"bl-form-field\"], [\"type\", \"text\", \"matInput\", \"\", \"cdkFocusInitial\", \"\", 3, \"formControl\", \"matAutocomplete\"], [\"autoActiveFirstOption\", \"\", 3, \"displayWith\", \"optionSelected\"], [\"auto\", \"matAutocomplete\"], [3, \"value\", 4, \"ngFor\", \"ngForOf\"], [4, \"ngFor\", \"ngForOf\"], [1, \"g-actions\"], [1, \"bl-button\", 3, \"mat-dialog-close\"], [1, \"bl-button\", 3, \"click\"], [1, \"add-dependency-relationship-dialog__story\"], [3, \"value\"]],\n  template: function AddDependencyRelationshipDialogComponent_Template(rf, ctx) {\n    if (rf & 1) {\n      i0.ɵɵelementStart(0, \"div\", 0)(1, \"h1\", 1)(2, \"span\");\n      i0.ɵɵtext(3, \"Add Dependency Relationship\");\n      i0.ɵɵelementEnd()();\n      i0.ɵɵelementStart(4, \"button\", 2)(5, \"mat-icon\");\n      i0.ɵɵtext(6, \" close \");\n      i0.ɵɵelementEnd()()();\n      i0.ɵɵtemplate(7, AddDependencyRelationshipDialogComponent_div_7_Template, 3, 2, \"div\", 3);\n      i0.ɵɵpipe(8, \"async\");\n      i0.ɵɵelementStart(9, \"mat-form-field\", 4)(10, \"mat-label\");\n      i0.ɵɵtext(11, \"Search:\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelement(12, \"input\", 5);\n      i0.ɵɵelementStart(13, \"mat-autocomplete\", 6, 7);\n      i0.ɵɵlistener(\"optionSelected\", function AddDependencyRelationshipDialogComponent_Template_mat_autocomplete_optionSelected_13_listener($event) {\n        return ctx.storySelected($event);\n      });\n      i0.ɵɵtemplate(15, AddDependencyRelationshipDialogComponent_mat_option_15_Template, 2, 2, \"mat-option\", 8);\n      i0.ɵɵpipe(16, \"async\");\n      i0.ɵɵelementEnd()();\n      i0.ɵɵelementStart(17, \"div\");\n      i0.ɵɵtemplate(18, AddDependencyRelationshipDialogComponent_span_18_Template, 2, 1, \"span\", 9);\n      i0.ɵɵpipe(19, \"async\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(20, \"div\", 10)(21, \"button\", 11);\n      i0.ɵɵtext(22, \"Cancel\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(23, \"button\", 12);\n      i0.ɵɵlistener(\"click\", function AddDependencyRelationshipDialogComponent_Template_button_click_23_listener() {\n        return ctx.save();\n      });\n      i0.ɵɵtext(24, \"Save\");\n      i0.ɵɵelementEnd()();\n    }\n\n    if (rf & 2) {\n      const _r1 = i0.ɵɵreference(14);\n\n      i0.ɵɵadvance(7);\n      i0.ɵɵproperty(\"ngIf\", i0.ɵɵpipeBind1(8, 6, ctx.story$));\n      i0.ɵɵadvance(5);\n      i0.ɵɵproperty(\"formControl\", ctx.searchControl)(\"matAutocomplete\", _r1);\n      i0.ɵɵadvance(1);\n      i0.ɵɵproperty(\"displayWith\", ctx.displayWith);\n      i0.ɵɵadvance(2);\n      i0.ɵɵproperty(\"ngForOf\", i0.ɵɵpipeBind1(16, 8, ctx.filteredOptions));\n      i0.ɵɵadvance(3);\n      i0.ɵɵproperty(\"ngForOf\", i0.ɵɵpipeBind1(19, 10, ctx.stories$));\n    }\n  },\n  directives: [i3.TitleBarDirective, i4.MatButton, i2.MatDialogClose, i5.MatIcon, i6.NgIf, i7.MatFormField, i7.MatLabel, i8.MatInput, i9.DefaultValueAccessor, i10.MatAutocompleteTrigger, i9.NgControlStatus, i9.FormControlDirective, i10.MatAutocomplete, i6.NgForOf, i11.MatOption],\n  pipes: [i6.AsyncPipe],\n  styles: [\"[_nghost-%COMP%] {\\n  display: block;\\n  width: 800px;\\n}\\n[_nghost-%COMP%]   .add-dependency-relationship-dialog__story[_ngcontent-%COMP%] {\\n  margin-bottom: 30px;\\n}\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFkZC1kZXBlbmRlbmN5LXJlbGF0aW9uc2hpcC1kaWFsb2cuY29tcG9uZW50LnNjc3MiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7RUFDRSxjQUFBO0VBQ0EsWUFBQTtBQUNGO0FBQ0U7RUFDRSxtQkFBQTtBQUNKIiwiZmlsZSI6ImFkZC1kZXBlbmRlbmN5LXJlbGF0aW9uc2hpcC1kaWFsb2cuY29tcG9uZW50LnNjc3MiLCJzb3VyY2VzQ29udGVudCI6WyI6aG9zdCB7XHJcbiAgZGlzcGxheTogYmxvY2s7XHJcbiAgd2lkdGg6IDgwMHB4O1xyXG5cclxuICAuYWRkLWRlcGVuZGVuY3ktcmVsYXRpb25zaGlwLWRpYWxvZ19fc3Rvcnkge1xyXG4gICAgbWFyZ2luLWJvdHRvbTogMzBweDtcclxuICB9XHJcbn1cclxuIl19 */\"]\n});","map":{"version":3,"sources":["C:/projects/Backlog/src/Backlog.App/src/app/@shared/components/dialogs/add-dependency-relationship-dialog/add-dependency-relationship-dialog.component.ts"],"names":["FormControl","MAT_DIALOG_DATA","Destroyable","BehaviorSubject","of","map","startWith","switchMap","takeUntil","tap","i0","i1","i2","i3","i4","i5","i6","i7","i8","i9","i10","i11","AddDependencyRelationshipDialogComponent_div_7_Template","rf","ctx","ɵɵelementStart","ɵɵtext","ɵɵelementEnd","story_r4","ngIf","ɵɵadvance","ɵɵtextInterpolate2","name","title","AddDependencyRelationshipDialogComponent_mat_option_15_Template","option_r5","$implicit","ɵɵproperty","ɵɵtextInterpolate1","AddDependencyRelationshipDialogComponent_span_18_Template","story_r6","AddDependencyRelationshipDialogComponent","constructor","_story","_storyService","_dialogRef","searchControl","story$","stories$","filteredOptions","valueChanges","pipe","value","search","query","displayWith","next","dependsOn","storySelected","$event","stories","index","indexOf","option","push","splice","reset","save","updateDependsOn","storyId","_destroyed$","_","close","subscribe","ɵfac","AddDependencyRelationshipDialogComponent_Factory","t","ɵɵdirectiveInject","StoryService","MatDialogRef","ɵcmp","ɵɵdefineComponent","type","selectors","features","ɵɵInheritDefinitionFeature","decls","vars","consts","template","AddDependencyRelationshipDialogComponent_Template","ɵɵtemplate","ɵɵpipe","ɵɵelement","ɵɵlistener","AddDependencyRelationshipDialogComponent_Template_mat_autocomplete_optionSelected_13_listener","AddDependencyRelationshipDialogComponent_Template_button_click_23_listener","_r1","ɵɵreference","ɵɵpipeBind1","directives","TitleBarDirective","MatButton","MatDialogClose","MatIcon","NgIf","MatFormField","MatLabel","MatInput","DefaultValueAccessor","MatAutocompleteTrigger","NgControlStatus","FormControlDirective","MatAutocomplete","NgForOf","MatOption","pipes","AsyncPipe","styles"],"mappings":"AAAA,SAASA,WAAT,QAA4B,gBAA5B;AACA,SAASC,eAAT,QAAgC,0BAAhC;AACA,SAASC,WAAT,QAA4B,OAA5B;AACA,SAASC,eAAT,EAA0BC,EAA1B,QAAoC,MAApC;AACA,SAASC,GAAT,EAAcC,SAAd,EAAyBC,SAAzB,EAAoCC,SAApC,EAA+CC,GAA/C,QAA0D,gBAA1D;AACA,OAAO,KAAKC,EAAZ,MAAoB,eAApB;AACA,OAAO,KAAKC,EAAZ,MAAoB,MAApB;AACA,OAAO,KAAKC,EAAZ,MAAoB,0BAApB;AACA,OAAO,KAAKC,EAAZ,MAAoB,8CAApB;AACA,OAAO,KAAKC,EAAZ,MAAoB,0BAApB;AACA,OAAO,KAAKC,EAAZ,MAAoB,wBAApB;AACA,OAAO,KAAKC,EAAZ,MAAoB,iBAApB;AACA,OAAO,KAAKC,EAAZ,MAAoB,8BAApB;AACA,OAAO,KAAKC,EAAZ,MAAoB,yBAApB;AACA,OAAO,KAAKC,EAAZ,MAAoB,gBAApB;AACA,OAAO,KAAKC,GAAZ,MAAqB,gCAArB;AACA,OAAO,KAAKC,GAAZ,MAAqB,wBAArB;;AACA,SAASC,uDAAT,CAAiEC,EAAjE,EAAqEC,GAArE,EAA0E;AAAE,MAAID,EAAE,GAAG,CAAT,EAAY;AACpFb,IAAAA,EAAE,CAACe,cAAH,CAAkB,CAAlB,EAAqB,KAArB,EAA4B,EAA5B,EAAgC,CAAhC,EAAmC,IAAnC;AACAf,IAAAA,EAAE,CAACgB,MAAH,CAAU,CAAV;AACAhB,IAAAA,EAAE,CAACiB,YAAH;AACH;;AAAC,MAAIJ,EAAE,GAAG,CAAT,EAAY;AACV,UAAMK,QAAQ,GAAGJ,GAAG,CAACK,IAArB;AACAnB,IAAAA,EAAE,CAACoB,SAAH,CAAa,CAAb;AACApB,IAAAA,EAAE,CAACqB,kBAAH,CAAsB,EAAtB,EAA0BH,QAAQ,CAACI,IAAnC,EAAyC,IAAzC,EAA+CJ,QAAQ,CAACK,KAAxD,EAA+D,EAA/D;AACH;AAAE;;AACH,SAASC,+DAAT,CAAyEX,EAAzE,EAA6EC,GAA7E,EAAkF;AAAE,MAAID,EAAE,GAAG,CAAT,EAAY;AAC5Fb,IAAAA,EAAE,CAACe,cAAH,CAAkB,CAAlB,EAAqB,YAArB,EAAmC,EAAnC;AACAf,IAAAA,EAAE,CAACgB,MAAH,CAAU,CAAV;AACAhB,IAAAA,EAAE,CAACiB,YAAH;AACH;;AAAC,MAAIJ,EAAE,GAAG,CAAT,EAAY;AACV,UAAMY,SAAS,GAAGX,GAAG,CAACY,SAAtB;AACA1B,IAAAA,EAAE,CAAC2B,UAAH,CAAc,OAAd,EAAuBF,SAAvB;AACAzB,IAAAA,EAAE,CAACoB,SAAH,CAAa,CAAb;AACApB,IAAAA,EAAE,CAAC4B,kBAAH,CAAsB,GAAtB,EAA2BH,SAAS,CAACH,IAArC,EAA2C,GAA3C;AACH;AAAE;;AACH,SAASO,yDAAT,CAAmEhB,EAAnE,EAAuEC,GAAvE,EAA4E;AAAE,MAAID,EAAE,GAAG,CAAT,EAAY;AACtFb,IAAAA,EAAE,CAACe,cAAH,CAAkB,CAAlB,EAAqB,MAArB;AACAf,IAAAA,EAAE,CAACgB,MAAH,CAAU,CAAV;AACAhB,IAAAA,EAAE,CAACiB,YAAH;AACH;;AAAC,MAAIJ,EAAE,GAAG,CAAT,EAAY;AACV,UAAMiB,QAAQ,GAAGhB,GAAG,CAACY,SAArB;AACA1B,IAAAA,EAAE,CAACoB,SAAH,CAAa,CAAb;AACApB,IAAAA,EAAE,CAAC4B,kBAAH,CAAsB,GAAtB,EAA2BE,QAA3B,EAAqC,GAArC;AACH;AAAE;;AACH,OAAO,MAAMC,wCAAN,SAAuDvC,WAAvD,CAAmE;AACtEwC,EAAAA,WAAW,CAACC,MAAD,EAASC,aAAT,EAAwBC,UAAxB,EAAoC;AAC3C;AACA,SAAKD,aAAL,GAAqBA,aAArB;AACA,SAAKC,UAAL,GAAkBA,UAAlB;AACA,SAAKC,aAAL,GAAqB,IAAI9C,WAAJ,CAAgB,IAAhB,EAAsB,EAAtB,CAArB;AACA,SAAK+C,MAAL,GAAc,IAAI5C,eAAJ,CAAoB,IAApB,CAAd;AACA,SAAK6C,QAAL,GAAgB,IAAI7C,eAAJ,CAAoB,EAApB,CAAhB;AACA,SAAK8C,eAAL,GAAuB,KAAKH,aAAL,CAAmBI,YAAnB,CAAgCC,IAAhC,CAAqC7C,SAAS,CAAC,EAAD,CAA9C,EAAoDD,GAAG,CAAC+C,KAAK,IAAK,OAAOA,KAAP,KAAiB,QAAjB,GAA4BA,KAA5B,GAAoCA,KAAK,IAAIA,KAAK,CAACpB,IAA9D,CAAvD,EAA6HzB,SAAS,CAACyB,IAAI,IAAKA,IAAI,GAAG,KAAKY,aAAL,CAAmBS,MAAnB,CAA0B;AAAEC,MAAAA,KAAK,EAAEtB;AAAT,KAA1B,CAAH,GAAgD5B,EAAE,CAAC,EAAD,CAAhE,CAAtI,CAAvB;;AACA,SAAKmD,WAAL,GAAmBH,KAAK,IAAIA,KAAK,KAAK,IAAV,IAAkBA,KAAK,KAAK,KAAK,CAAjC,GAAqC,KAAK,CAA1C,GAA8CA,KAAK,CAACpB,IAAhF;;AACA,SAAKgB,QAAL,CAAcQ,IAAd,CAAmBb,MAAM,CAACc,SAA1B;AACA,SAAKV,MAAL,CAAYS,IAAZ,CAAiBb,MAAjB;AACH;;AACDe,EAAAA,aAAa,CAACC,MAAD,EAAS;AAClB,QAAIC,OAAO,GAAG,KAAKZ,QAAL,CAAcI,KAA5B;AACA,UAAMS,KAAK,GAAGD,OAAO,CAACE,OAAR,CAAgBH,MAAM,CAACI,MAAP,CAAcX,KAAd,CAAoBpB,IAApC,CAAd;;AACA,QAAI6B,KAAK,IAAI,CAAC,CAAd,EAAiB;AACbD,MAAAA,OAAO,CAACI,IAAR,CAAaL,MAAM,CAACI,MAAP,CAAcX,KAAd,CAAoBpB,IAAjC;AACH,KAFD,MAGK;AACD4B,MAAAA,OAAO,CAACK,MAAR,CAAeJ,KAAf,EAAsB,CAAtB;AACH;;AACD,SAAKb,QAAL,CAAcQ,IAAd,CAAmBI,OAAnB;AACA,SAAKd,aAAL,CAAmBoB,KAAnB;AACH;;AACDC,EAAAA,IAAI,GAAG;AACH,SAAKvB,aAAL,CAAmBwB,eAAnB,CAAmC;AAAEC,MAAAA,OAAO,EAAE,KAAKtB,MAAL,CAAYK,KAAZ,CAAkBiB,OAA7B;AAAsCZ,MAAAA,SAAS,EAAE,KAAKT,QAAL,CAAcI;AAA/D,KAAnC,EACKD,IADL,CACU3C,SAAS,CAAC,KAAK8D,WAAN,CADnB,EACuC7D,GAAG,CAAC8D,CAAC,IAAI;AAC5C,WAAK1B,UAAL,CAAgB2B,KAAhB,CAAsB,IAAtB;AACH,KAFyC,CAD1C,EAGIC,SAHJ;AAIH;;AA9BqE;;AAgC1EhC,wCAAwC,CAACiC,IAAzC,GAAgD,SAASC,gDAAT,CAA0DC,CAA1D,EAA6D;AAAE,SAAO,KAAKA,CAAC,IAAInC,wCAAV,EAAoD/B,EAAE,CAACmE,iBAAH,CAAqB5E,eAArB,CAApD,EAA2FS,EAAE,CAACmE,iBAAH,CAAqBlE,EAAE,CAACmE,YAAxB,CAA3F,EAAkIpE,EAAE,CAACmE,iBAAH,CAAqBjE,EAAE,CAACmE,YAAxB,CAAlI,CAAP;AAAkL,CAAjS;;AACAtC,wCAAwC,CAACuC,IAAzC,GAAgD,aAActE,EAAE,CAACuE,iBAAH,CAAqB;AAAEC,EAAAA,IAAI,EAAEzC,wCAAR;AAAkD0C,EAAAA,SAAS,EAAE,CAAC,CAAC,uCAAD,CAAD,CAA7D;AAA0GC,EAAAA,QAAQ,EAAE,CAAC1E,EAAE,CAAC2E,0BAAJ,CAApH;AAAqJC,EAAAA,KAAK,EAAE,EAA5J;AAAgKC,EAAAA,IAAI,EAAE,EAAtK;AAA0KC,EAAAA,MAAM,EAAE,CAAC,CAAC,cAAD,EAAiB,EAAjB,CAAD,EAAuB,CAAC,UAAD,EAAa,EAAb,CAAvB,EAAyC,CAAC,iBAAD,EAAoB,EAApB,EAAwB,UAAxB,EAAoC,IAApC,EAA0C,CAA1C,EAA6C,kBAA7C,CAAzC,EAA2G,CAAC,OAAD,EAAU,2CAAV,EAAuD,CAAvD,EAA0D,MAA1D,CAA3G,EAA8K,CAAC,CAAD,EAAI,eAAJ,CAA9K,EAAoM,CAAC,MAAD,EAAS,MAAT,EAAiB,UAAjB,EAA6B,EAA7B,EAAiC,iBAAjC,EAAoD,EAApD,EAAwD,CAAxD,EAA2D,aAA3D,EAA0E,iBAA1E,CAApM,EAAkS,CAAC,uBAAD,EAA0B,EAA1B,EAA8B,CAA9B,EAAiC,aAAjC,EAAgD,gBAAhD,CAAlS,EAAqW,CAAC,MAAD,EAAS,iBAAT,CAArW,EAAkY,CAAC,CAAD,EAAI,OAAJ,EAAa,CAAb,EAAgB,OAAhB,EAAyB,SAAzB,CAAlY,EAAua,CAAC,CAAD,EAAI,OAAJ,EAAa,SAAb,CAAva,EAAgc,CAAC,CAAD,EAAI,WAAJ,CAAhc,EAAkd,CAAC,CAAD,EAAI,WAAJ,EAAiB,CAAjB,EAAoB,kBAApB,CAAld,EAA2f,CAAC,CAAD,EAAI,WAAJ,EAAiB,CAAjB,EAAoB,OAApB,CAA3f,EAAyhB,CAAC,CAAD,EAAI,2CAAJ,CAAzhB,EAA2kB,CAAC,CAAD,EAAI,OAAJ,CAA3kB,CAAlL;AAA4wBC,EAAAA,QAAQ,EAAE,SAASC,iDAAT,CAA2DnE,EAA3D,EAA+DC,GAA/D,EAAoE;AAAE,QAAID,EAAE,GAAG,CAAT,EAAY;AACn7Bb,MAAAA,EAAE,CAACe,cAAH,CAAkB,CAAlB,EAAqB,KAArB,EAA4B,CAA5B,EAA+B,CAA/B,EAAkC,IAAlC,EAAwC,CAAxC,EAA2C,CAA3C,EAA8C,MAA9C;AACAf,MAAAA,EAAE,CAACgB,MAAH,CAAU,CAAV,EAAa,6BAAb;AACAhB,MAAAA,EAAE,CAACiB,YAAH;AACAjB,MAAAA,EAAE,CAACe,cAAH,CAAkB,CAAlB,EAAqB,QAArB,EAA+B,CAA/B,EAAkC,CAAlC,EAAqC,UAArC;AACAf,MAAAA,EAAE,CAACgB,MAAH,CAAU,CAAV,EAAa,SAAb;AACAhB,MAAAA,EAAE,CAACiB,YAAH;AACAjB,MAAAA,EAAE,CAACiF,UAAH,CAAc,CAAd,EAAiBrE,uDAAjB,EAA0E,CAA1E,EAA6E,CAA7E,EAAgF,KAAhF,EAAuF,CAAvF;AACAZ,MAAAA,EAAE,CAACkF,MAAH,CAAU,CAAV,EAAa,OAAb;AACAlF,MAAAA,EAAE,CAACe,cAAH,CAAkB,CAAlB,EAAqB,gBAArB,EAAuC,CAAvC,EAA0C,EAA1C,EAA8C,WAA9C;AACAf,MAAAA,EAAE,CAACgB,MAAH,CAAU,EAAV,EAAc,SAAd;AACAhB,MAAAA,EAAE,CAACiB,YAAH;AACAjB,MAAAA,EAAE,CAACmF,SAAH,CAAa,EAAb,EAAiB,OAAjB,EAA0B,CAA1B;AACAnF,MAAAA,EAAE,CAACe,cAAH,CAAkB,EAAlB,EAAsB,kBAAtB,EAA0C,CAA1C,EAA6C,CAA7C;AACAf,MAAAA,EAAE,CAACoF,UAAH,CAAc,gBAAd,EAAgC,SAASC,6FAAT,CAAuGpC,MAAvG,EAA+G;AAAE,eAAOnC,GAAG,CAACkC,aAAJ,CAAkBC,MAAlB,CAAP;AAAmC,OAApL;AACAjD,MAAAA,EAAE,CAACiF,UAAH,CAAc,EAAd,EAAkBzD,+DAAlB,EAAmF,CAAnF,EAAsF,CAAtF,EAAyF,YAAzF,EAAuG,CAAvG;AACAxB,MAAAA,EAAE,CAACkF,MAAH,CAAU,EAAV,EAAc,OAAd;AACAlF,MAAAA,EAAE,CAACiB,YAAH;AACAjB,MAAAA,EAAE,CAACe,cAAH,CAAkB,EAAlB,EAAsB,KAAtB;AACAf,MAAAA,EAAE,CAACiF,UAAH,CAAc,EAAd,EAAkBpD,yDAAlB,EAA6E,CAA7E,EAAgF,CAAhF,EAAmF,MAAnF,EAA2F,CAA3F;AACA7B,MAAAA,EAAE,CAACkF,MAAH,CAAU,EAAV,EAAc,OAAd;AACAlF,MAAAA,EAAE,CAACiB,YAAH;AACAjB,MAAAA,EAAE,CAACe,cAAH,CAAkB,EAAlB,EAAsB,KAAtB,EAA6B,EAA7B,EAAiC,EAAjC,EAAqC,QAArC,EAA+C,EAA/C;AACAf,MAAAA,EAAE,CAACgB,MAAH,CAAU,EAAV,EAAc,QAAd;AACAhB,MAAAA,EAAE,CAACiB,YAAH;AACAjB,MAAAA,EAAE,CAACe,cAAH,CAAkB,EAAlB,EAAsB,QAAtB,EAAgC,EAAhC;AACAf,MAAAA,EAAE,CAACoF,UAAH,CAAc,OAAd,EAAuB,SAASE,0EAAT,GAAsF;AAAE,eAAOxE,GAAG,CAAC2C,IAAJ,EAAP;AAAoB,OAAnI;AACAzD,MAAAA,EAAE,CAACgB,MAAH,CAAU,EAAV,EAAc,MAAd;AACAhB,MAAAA,EAAE,CAACiB,YAAH;AACH;;AAAC,QAAIJ,EAAE,GAAG,CAAT,EAAY;AACV,YAAM0E,GAAG,GAAGvF,EAAE,CAACwF,WAAH,CAAe,EAAf,CAAZ;;AACAxF,MAAAA,EAAE,CAACoB,SAAH,CAAa,CAAb;AACApB,MAAAA,EAAE,CAAC2B,UAAH,CAAc,MAAd,EAAsB3B,EAAE,CAACyF,WAAH,CAAe,CAAf,EAAkB,CAAlB,EAAqB3E,GAAG,CAACuB,MAAzB,CAAtB;AACArC,MAAAA,EAAE,CAACoB,SAAH,CAAa,CAAb;AACApB,MAAAA,EAAE,CAAC2B,UAAH,CAAc,aAAd,EAA6Bb,GAAG,CAACsB,aAAjC,EAAgD,iBAAhD,EAAmEmD,GAAnE;AACAvF,MAAAA,EAAE,CAACoB,SAAH,CAAa,CAAb;AACApB,MAAAA,EAAE,CAAC2B,UAAH,CAAc,aAAd,EAA6Bb,GAAG,CAAC+B,WAAjC;AACA7C,MAAAA,EAAE,CAACoB,SAAH,CAAa,CAAb;AACApB,MAAAA,EAAE,CAAC2B,UAAH,CAAc,SAAd,EAAyB3B,EAAE,CAACyF,WAAH,CAAe,EAAf,EAAmB,CAAnB,EAAsB3E,GAAG,CAACyB,eAA1B,CAAzB;AACAvC,MAAAA,EAAE,CAACoB,SAAH,CAAa,CAAb;AACApB,MAAAA,EAAE,CAAC2B,UAAH,CAAc,SAAd,EAAyB3B,EAAE,CAACyF,WAAH,CAAe,EAAf,EAAmB,EAAnB,EAAuB3E,GAAG,CAACwB,QAA3B,CAAzB;AACH;AAAE,GAzC4E;AAyC1EoD,EAAAA,UAAU,EAAE,CAACvF,EAAE,CAACwF,iBAAJ,EAAuBvF,EAAE,CAACwF,SAA1B,EAAqC1F,EAAE,CAAC2F,cAAxC,EAAwDxF,EAAE,CAACyF,OAA3D,EAAoExF,EAAE,CAACyF,IAAvE,EAA6ExF,EAAE,CAACyF,YAAhF,EAA8FzF,EAAE,CAAC0F,QAAjG,EAA2GzF,EAAE,CAAC0F,QAA9G,EAAwHzF,EAAE,CAAC0F,oBAA3H,EAAiJzF,GAAG,CAAC0F,sBAArJ,EAA6K3F,EAAE,CAAC4F,eAAhL,EAAiM5F,EAAE,CAAC6F,oBAApM,EAA0N5F,GAAG,CAAC6F,eAA9N,EAA+OjG,EAAE,CAACkG,OAAlP,EAA2P7F,GAAG,CAAC8F,SAA/P,CAzC8D;AAyC6MC,EAAAA,KAAK,EAAE,CAACpG,EAAE,CAACqG,SAAJ,CAzCpN;AAyCoOC,EAAAA,MAAM,EAAE,CAAC,ytBAAD;AAzC5O,CAArB,CAA9D","sourcesContent":["import { FormControl } from '@angular/forms';\r\nimport { MAT_DIALOG_DATA } from '@angular/material/dialog';\r\nimport { Destroyable } from '@core';\r\nimport { BehaviorSubject, of } from 'rxjs';\r\nimport { map, startWith, switchMap, takeUntil, tap } from 'rxjs/operators';\r\nimport * as i0 from \"@angular/core\";\r\nimport * as i1 from \"@api\";\r\nimport * as i2 from \"@angular/material/dialog\";\r\nimport * as i3 from \"../../../atoms/title-bar/title-bar.directive\";\r\nimport * as i4 from \"@angular/material/button\";\r\nimport * as i5 from \"@angular/material/icon\";\r\nimport * as i6 from \"@angular/common\";\r\nimport * as i7 from \"@angular/material/form-field\";\r\nimport * as i8 from \"@angular/material/input\";\r\nimport * as i9 from \"@angular/forms\";\r\nimport * as i10 from \"@angular/material/autocomplete\";\r\nimport * as i11 from \"@angular/material/core\";\r\nfunction AddDependencyRelationshipDialogComponent_div_7_Template(rf, ctx) { if (rf & 1) {\r\n    i0.ɵɵelementStart(0, \"div\", 13)(1, \"h1\");\r\n    i0.ɵɵtext(2);\r\n    i0.ɵɵelementEnd()();\r\n} if (rf & 2) {\r\n    const story_r4 = ctx.ngIf;\r\n    i0.ɵɵadvance(2);\r\n    i0.ɵɵtextInterpolate2(\"\", story_r4.name, \": \", story_r4.title, \"\");\r\n} }\r\nfunction AddDependencyRelationshipDialogComponent_mat_option_15_Template(rf, ctx) { if (rf & 1) {\r\n    i0.ɵɵelementStart(0, \"mat-option\", 14);\r\n    i0.ɵɵtext(1);\r\n    i0.ɵɵelementEnd();\r\n} if (rf & 2) {\r\n    const option_r5 = ctx.$implicit;\r\n    i0.ɵɵproperty(\"value\", option_r5);\r\n    i0.ɵɵadvance(1);\r\n    i0.ɵɵtextInterpolate1(\" \", option_r5.name, \" \");\r\n} }\r\nfunction AddDependencyRelationshipDialogComponent_span_18_Template(rf, ctx) { if (rf & 1) {\r\n    i0.ɵɵelementStart(0, \"span\");\r\n    i0.ɵɵtext(1);\r\n    i0.ɵɵelementEnd();\r\n} if (rf & 2) {\r\n    const story_r6 = ctx.$implicit;\r\n    i0.ɵɵadvance(1);\r\n    i0.ɵɵtextInterpolate1(\" \", story_r6, \" \");\r\n} }\r\nexport class AddDependencyRelationshipDialogComponent extends Destroyable {\r\n    constructor(_story, _storyService, _dialogRef) {\r\n        super();\r\n        this._storyService = _storyService;\r\n        this._dialogRef = _dialogRef;\r\n        this.searchControl = new FormControl(null, []);\r\n        this.story$ = new BehaviorSubject(null);\r\n        this.stories$ = new BehaviorSubject([]);\r\n        this.filteredOptions = this.searchControl.valueChanges.pipe(startWith(\"\"), map(value => (typeof value === \"string\" ? value : value && value.name)), switchMap(name => (name ? this._storyService.search({ query: name }) : of([]))));\r\n        this.displayWith = value => value === null || value === void 0 ? void 0 : value.name;\r\n        this.stories$.next(_story.dependsOn);\r\n        this.story$.next(_story);\r\n    }\r\n    storySelected($event) {\r\n        var stories = this.stories$.value;\r\n        const index = stories.indexOf($event.option.value.name);\r\n        if (index == -1) {\r\n            stories.push($event.option.value.name);\r\n        }\r\n        else {\r\n            stories.splice(index, 1);\r\n        }\r\n        this.stories$.next(stories);\r\n        this.searchControl.reset();\r\n    }\r\n    save() {\r\n        this._storyService.updateDependsOn({ storyId: this.story$.value.storyId, dependsOn: this.stories$.value })\r\n            .pipe(takeUntil(this._destroyed$), tap(_ => {\r\n            this._dialogRef.close(true);\r\n        })).subscribe();\r\n    }\r\n}\r\nAddDependencyRelationshipDialogComponent.ɵfac = function AddDependencyRelationshipDialogComponent_Factory(t) { return new (t || AddDependencyRelationshipDialogComponent)(i0.ɵɵdirectiveInject(MAT_DIALOG_DATA), i0.ɵɵdirectiveInject(i1.StoryService), i0.ɵɵdirectiveInject(i2.MatDialogRef)); };\r\nAddDependencyRelationshipDialogComponent.ɵcmp = /*@__PURE__*/ i0.ɵɵdefineComponent({ type: AddDependencyRelationshipDialogComponent, selectors: [[\"bl-add-dependency-relationship-dialog\"]], features: [i0.ɵɵInheritDefinitionFeature], decls: 25, vars: 12, consts: [[\"bl-title-bar\", \"\"], [\"bl-title\", \"\"], [\"mat-icon-button\", \"\", \"tabindex\", \"-1\", 3, \"mat-dialog-close\"], [\"class\", \"add-dependency-relationship-dialog__story\", 4, \"ngIf\"], [1, \"bl-form-field\"], [\"type\", \"text\", \"matInput\", \"\", \"cdkFocusInitial\", \"\", 3, \"formControl\", \"matAutocomplete\"], [\"autoActiveFirstOption\", \"\", 3, \"displayWith\", \"optionSelected\"], [\"auto\", \"matAutocomplete\"], [3, \"value\", 4, \"ngFor\", \"ngForOf\"], [4, \"ngFor\", \"ngForOf\"], [1, \"g-actions\"], [1, \"bl-button\", 3, \"mat-dialog-close\"], [1, \"bl-button\", 3, \"click\"], [1, \"add-dependency-relationship-dialog__story\"], [3, \"value\"]], template: function AddDependencyRelationshipDialogComponent_Template(rf, ctx) { if (rf & 1) {\r\n        i0.ɵɵelementStart(0, \"div\", 0)(1, \"h1\", 1)(2, \"span\");\r\n        i0.ɵɵtext(3, \"Add Dependency Relationship\");\r\n        i0.ɵɵelementEnd()();\r\n        i0.ɵɵelementStart(4, \"button\", 2)(5, \"mat-icon\");\r\n        i0.ɵɵtext(6, \" close \");\r\n        i0.ɵɵelementEnd()()();\r\n        i0.ɵɵtemplate(7, AddDependencyRelationshipDialogComponent_div_7_Template, 3, 2, \"div\", 3);\r\n        i0.ɵɵpipe(8, \"async\");\r\n        i0.ɵɵelementStart(9, \"mat-form-field\", 4)(10, \"mat-label\");\r\n        i0.ɵɵtext(11, \"Search:\");\r\n        i0.ɵɵelementEnd();\r\n        i0.ɵɵelement(12, \"input\", 5);\r\n        i0.ɵɵelementStart(13, \"mat-autocomplete\", 6, 7);\r\n        i0.ɵɵlistener(\"optionSelected\", function AddDependencyRelationshipDialogComponent_Template_mat_autocomplete_optionSelected_13_listener($event) { return ctx.storySelected($event); });\r\n        i0.ɵɵtemplate(15, AddDependencyRelationshipDialogComponent_mat_option_15_Template, 2, 2, \"mat-option\", 8);\r\n        i0.ɵɵpipe(16, \"async\");\r\n        i0.ɵɵelementEnd()();\r\n        i0.ɵɵelementStart(17, \"div\");\r\n        i0.ɵɵtemplate(18, AddDependencyRelationshipDialogComponent_span_18_Template, 2, 1, \"span\", 9);\r\n        i0.ɵɵpipe(19, \"async\");\r\n        i0.ɵɵelementEnd();\r\n        i0.ɵɵelementStart(20, \"div\", 10)(21, \"button\", 11);\r\n        i0.ɵɵtext(22, \"Cancel\");\r\n        i0.ɵɵelementEnd();\r\n        i0.ɵɵelementStart(23, \"button\", 12);\r\n        i0.ɵɵlistener(\"click\", function AddDependencyRelationshipDialogComponent_Template_button_click_23_listener() { return ctx.save(); });\r\n        i0.ɵɵtext(24, \"Save\");\r\n        i0.ɵɵelementEnd()();\r\n    } if (rf & 2) {\r\n        const _r1 = i0.ɵɵreference(14);\r\n        i0.ɵɵadvance(7);\r\n        i0.ɵɵproperty(\"ngIf\", i0.ɵɵpipeBind1(8, 6, ctx.story$));\r\n        i0.ɵɵadvance(5);\r\n        i0.ɵɵproperty(\"formControl\", ctx.searchControl)(\"matAutocomplete\", _r1);\r\n        i0.ɵɵadvance(1);\r\n        i0.ɵɵproperty(\"displayWith\", ctx.displayWith);\r\n        i0.ɵɵadvance(2);\r\n        i0.ɵɵproperty(\"ngForOf\", i0.ɵɵpipeBind1(16, 8, ctx.filteredOptions));\r\n        i0.ɵɵadvance(3);\r\n        i0.ɵɵproperty(\"ngForOf\", i0.ɵɵpipeBind1(19, 10, ctx.stories$));\r\n    } }, directives: [i3.TitleBarDirective, i4.MatButton, i2.MatDialogClose, i5.MatIcon, i6.NgIf, i7.MatFormField, i7.MatLabel, i8.MatInput, i9.DefaultValueAccessor, i10.MatAutocompleteTrigger, i9.NgControlStatus, i9.FormControlDirective, i10.MatAutocomplete, i6.NgForOf, i11.MatOption], pipes: [i6.AsyncPipe], styles: [\"[_nghost-%COMP%] {\\n  display: block;\\n  width: 800px;\\n}\\n[_nghost-%COMP%]   .add-dependency-relationship-dialog__story[_ngcontent-%COMP%] {\\n  margin-bottom: 30px;\\n}\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFkZC1kZXBlbmRlbmN5LXJlbGF0aW9uc2hpcC1kaWFsb2cuY29tcG9uZW50LnNjc3MiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7RUFDRSxjQUFBO0VBQ0EsWUFBQTtBQUNGO0FBQ0U7RUFDRSxtQkFBQTtBQUNKIiwiZmlsZSI6ImFkZC1kZXBlbmRlbmN5LXJlbGF0aW9uc2hpcC1kaWFsb2cuY29tcG9uZW50LnNjc3MiLCJzb3VyY2VzQ29udGVudCI6WyI6aG9zdCB7XHJcbiAgZGlzcGxheTogYmxvY2s7XHJcbiAgd2lkdGg6IDgwMHB4O1xyXG5cclxuICAuYWRkLWRlcGVuZGVuY3ktcmVsYXRpb25zaGlwLWRpYWxvZ19fc3Rvcnkge1xyXG4gICAgbWFyZ2luLWJvdHRvbTogMzBweDtcclxuICB9XHJcbn1cclxuIl19 */\"] });\r\n"]},"metadata":{},"sourceType":"module"}